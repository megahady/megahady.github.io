function plot(selectedSignalName) {
  let selectedSignal, selectedLabel, selectedColor;

  if (selectedSignalName === 'pdet') {
    selectedSignal = pdet;
    selectedLabel = 'Pdet';
    selectedColor = 'red';
  } else if (selectedSignalName === 'pdetcalc') {
    selectedSignal = pdetcalc;
    selectedLabel = 'Pdet Calculated';
    selectedColor = 'purple';
  } else if (selectedSignalName === 'postpdet') {
    selectedSignal = postpdet;
    selectedLabel = 'Post-Processed';
    selectedColor = 'orange';
  } else if (selectedSignalName === 'postpdetwavelet') {
    selectedSignal = postpdetwavelet;
    selectedLabel = 'Wavelet';
    selectedColor = 'black';
  }

  const traces = [
    {
      x: time, y: pves, type: 'scatter', fill: 'tozeroy',
      line: {color: 'blue'}, name: 'Pves',
      yaxis: 'y1'
    },
    {
      x: time, y: emg, type: 'scatter', fill: 'tozeroy',
      line: {color: 'green'}, name: 'EMG',
      yaxis: 'y2'
    },
    {
      x: time, y: pabd, type: 'scatter', fill: 'tozeroy',
      line: {color: 'orange'}, name: 'Pabd',
      yaxis: 'y3'
    },
    {
      x: time, y: selectedSignal, type: 'scatter', fill: 'tozeroy',
      line: {color: selectedColor}, name: selectedLabel,
      yaxis: 'y4'
    }
  ];

  const layout = {
    height: 1000,
    showlegend: false,
    xaxis: {
      title: 'Time (min)',
      domain: [0, 1],
      anchor: 'y1'
    },
    yaxis: {
      title: 'Pves (cmH₂O)',
      range: [-20, 100],
      domain: [0.75, 1]
    },
    yaxis2: {
      title: 'EMG (µV)',
      range: [0, 10],
      domain: [0.5, 0.75],
      anchor: 'x'
    },
    yaxis3: {
      title: 'Pabd (cmH₂O)',
      range: [-20, 100],
      domain: [0.25, 0.5],
      anchor: 'x'
    },
    yaxis4: {
      title: selectedLabel + ' (cmH₂O)',
      range: [-20, 100],
      domain: [0, 0.25],
      anchor: 'x'
    }
  };

  Plotly.newPlot('plot', traces, layout, {responsive: true});
}
